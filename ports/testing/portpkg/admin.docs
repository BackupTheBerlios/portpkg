#!/bin/sh -u
# admin.prepare -- sync documentation with portpkg.berlios.de wiki
#                  do this before releasing a new portpkg
#                  FOR PORTPKG ADMINISTRATION ONLY

. `which portpkg` || exit 1

has_prog elinks || die

stanza "Syncing docs:"
for doc in FrontPage QuickStart PortpkgGuide TodoBugsAbout QuestionsAndAnswers \
Links UpcomingRelease; do
  row "$doc"
  wget -O $doc.html http://portpkg.berlios.de/doc.php?page=$doc 2>/dev/null
  elinks -no-numbering -dump $doc.html | grep -v "^[ ]*EditThisPage" >README.$doc
  rm $doc.html
done

row "Finishing"
sed -i "/ file:\/\//d" README.*
sed -i "0,/^News$/d" README.FrontPage
sed -i "1s,.*,News\n," README.FrontPage
mv README.TodoBugsAbout ABOUT
mv README.PortpkgGuide README
mv README.FrontPage NEWS
mv README.QuestionsAndAnswers FAQ
mv README.UpcomingRelease ROADMAP
